<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="title多少有点震惊党的意思，但说实话，这还不是因为LeetCode太抠了，才给20道MySQL的题目。 而且，这里的题目有些很简单，简单地离谱，有些则复杂的难以言喻； 学习还是不能走太多的捷径，加油吧少年。">
<meta property="og:type" content="article">
<meta property="og:title" content="一天刷完LeetCode上的MySQL题">
<meta property="og:url" content="http://example.com/2021/05/19/%E4%B8%80%E5%A4%A9%E5%88%B7%E5%AE%8CLeetCode%E4%B8%8A%E7%9A%84MySQL%E9%A2%98/index.html">
<meta property="og:site_name" content="Zek Shawn">
<meta property="og:description" content="title多少有点震惊党的意思，但说实话，这还不是因为LeetCode太抠了，才给20道MySQL的题目。 而且，这里的题目有些很简单，简单地离谱，有些则复杂的难以言喻； 学习还是不能走太多的捷径，加油吧少年。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://pic.imgdb.cn/item/60a5099c6ae4f77d35bfd5b9.png">
<meta property="og:image" content="https://pic.imgdb.cn/item/60a50a026ae4f77d35c362d7.png">
<meta property="og:image" content="https://pic.imgdb.cn/item/60a50d046ae4f77d35dd644b.png">
<meta property="og:image" content="https://pic.imgdb.cn/item/60a50f1d6ae4f77d35eef345.png">
<meta property="og:image" content="https://pic.imgdb.cn/item/60a50eef6ae4f77d35ed7293.png">
<meta property="og:image" content="https://pic.imgdb.cn/item/60a50f446ae4f77d35f0429a.png">
<meta property="og:image" content="https://pic.imgdb.cn/item/60a50f9d6ae4f77d35f362b1.png">
<meta property="og:image" content="https://pic.imgdb.cn/item/60a50fd56ae4f77d35f54ed3.png">
<meta property="og:image" content="https://pic.imgdb.cn/item/60a510096ae4f77d35f72d02.png">
<meta property="og:image" content="https://pic.imgdb.cn/item/60a510926ae4f77d35fbf9ad.png">
<meta property="og:image" content="https://pic.imgdb.cn/item/60a510756ae4f77d35faf54d.png">
<meta property="og:image" content="https://pic.imgdb.cn/item/60a510ac6ae4f77d35fcf536.png">
<meta property="og:image" content="https://pic.imgdb.cn/item/60a510f56ae4f77d35ff9da2.png">
<meta property="og:image" content="https://pic.imgdb.cn/item/60a511296ae4f77d3501819d.png">
<meta property="og:image" content="https://pic.imgdb.cn/item/60a511596ae4f77d35033855.png">
<meta property="og:image" content="https://pic.imgdb.cn/item/60a511926ae4f77d35052e73.png">
<meta property="og:image" content="https://pic.imgdb.cn/item/60a511c56ae4f77d3506e869.png">
<meta property="og:image" content="https://pic.imgdb.cn/item/60a512066ae4f77d35090f69.png">
<meta property="og:image" content="https://pic.imgdb.cn/item/60a5122c6ae4f77d350a53fc.png">
<meta property="og:image" content="https://pic.imgdb.cn/item/60a5125d6ae4f77d350c0426.png">
<meta property="article:published_time" content="2021-05-19T12:45:26.000Z">
<meta property="article:modified_time" content="2021-05-20T05:49:03.776Z">
<meta property="article:author" content="Zek Shawn">
<meta property="article:tag" content="MySQL">
<meta property="article:tag" content="LeetCode">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pic.imgdb.cn/item/60a5099c6ae4f77d35bfd5b9.png">

<link rel="canonical" href="http://example.com/2021/05/19/%E4%B8%80%E5%A4%A9%E5%88%B7%E5%AE%8CLeetCode%E4%B8%8A%E7%9A%84MySQL%E9%A2%98/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>一天刷完LeetCode上的MySQL题 | Zek Shawn</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Zek Shawn</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/05/19/%E4%B8%80%E5%A4%A9%E5%88%B7%E5%AE%8CLeetCode%E4%B8%8A%E7%9A%84MySQL%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Zek Shawn">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zek Shawn">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          一天刷完LeetCode上的MySQL题
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-05-19 20:45:26" itemprop="dateCreated datePublished" datetime="2021-05-19T20:45:26+08:00">2021-05-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-05-20 13:49:03" itemprop="dateModified" datetime="2021-05-20T13:49:03+08:00">2021-05-20</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>title多少有点震惊党的意思，但说实话，这还不是因为LeetCode太抠了，才给20道MySQL的题目。</p>
<p>而且，这里的题目有些很简单，简单地离谱，有些则复杂的难以言喻；</p>
<p>学习还是不能走太多的捷径，加油吧少年。</p>
<span id="more"></span>

<h2 id="LeetCode175-组合两个表"><a href="#LeetCode175-组合两个表" class="headerlink" title="LeetCode175 - 组合两个表"></a>LeetCode175 - 组合两个表</h2><p><img src="https://pic.imgdb.cn/item/60a5099c6ae4f77d35bfd5b9.png" alt="image-20210519205035755"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 是个简单题，思路也很简单，就是通过左连接</span><br><span class="line">select </span><br><span class="line">    FirstName, LastName, City, State </span><br><span class="line">from </span><br><span class="line">    Person left join Address on Person.PersonId=Address.PersonId;</span><br></pre></td></tr></table></figure>

<h2 id="LeetCode176-第二高的薪水"><a href="#LeetCode176-第二高的薪水" class="headerlink" title="LeetCode176 - 第二高的薪水"></a>LeetCode176 - 第二高的薪水</h2><p><img src="https://pic.imgdb.cn/item/60a50a026ae4f77d35c362d7.png" alt="image-20210519205218142"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 思路也很简单，基本上就是对排序+去重操作的考察，order by + distinct，关键点在于没有的情况下返回null，这里只要再套一层查询即可</span><br><span class="line">select </span><br><span class="line">    (select </span><br><span class="line">        distinct Salary </span><br><span class="line">    from </span><br><span class="line">        Employee </span><br><span class="line">    order by </span><br><span class="line">        Salary desc limit 1,1</span><br><span class="line">    ) as SecondHighestSalary;</span><br></pre></td></tr></table></figure>

<h2 id="LeetCode177-第N高的薪水"><a href="#LeetCode177-第N高的薪水" class="headerlink" title="LeetCode177 - 第N高的薪水"></a>LeetCode177 - 第N高的薪水</h2><p><img src="https://pic.imgdb.cn/item/60a50d046ae4f77d35dd644b.png" alt="image-20210519210508567"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 题目跟前面那一题差不多，唯一需要注意的是，N需要提前设定为N-1，因为索引是从0开始的</span><br><span class="line"># 直接设置为N-1，貌似会报错</span><br><span class="line">CREATE FUNCTION getNthHighestSalary(N INT) RETURNS INT</span><br><span class="line">BEGIN</span><br><span class="line">  set N=N-1;</span><br><span class="line">  RETURN (</span><br><span class="line">      # Write your MySQL query statement below.</span><br><span class="line">      select distinct Salary from Employee order by Salary desc limit N, 1</span><br><span class="line">  );</span><br><span class="line">END</span><br></pre></td></tr></table></figure>

<h2 id="LeetCode178-分数排名"><a href="#LeetCode178-分数排名" class="headerlink" title="LeetCode178 - 分数排名"></a>LeetCode178 - 分数排名</h2><p><img src="https://pic.imgdb.cn/item/60a50f1d6ae4f77d35eef345.png" alt="image-20210519211404995"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 可以使用两张表联合查询实现分数排名</span><br><span class="line">select </span><br><span class="line">	s1.Score, count(distinct(s2.Score)) as &#x27;Rank&#x27; </span><br><span class="line">from </span><br><span class="line">	Scores s1, Scores s2 </span><br><span class="line">where </span><br><span class="line">	s1.Score &lt;= s2.Score </span><br><span class="line">group by </span><br><span class="line">	s1.Id </span><br><span class="line">order by </span><br><span class="line">	s1.Score desc;</span><br></pre></td></tr></table></figure>

<h2 id="LeetCode180-Z字形变换"><a href="#LeetCode180-Z字形变换" class="headerlink" title="LeetCode180 - Z字形变换"></a>LeetCode180 - Z字形变换</h2><p><img src="https://pic.imgdb.cn/item/60a50eef6ae4f77d35ed7293.png" alt="image-20210519211318811"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">select distinct Num as ConsecutiveNums from</span><br><span class="line">    (select Num,</span><br><span class="line">        case </span><br><span class="line">            when @prev = Num then @count := @count + 1</span><br><span class="line">            when (@prev := Num) is not null then @count := 1</span><br><span class="line">        end as CNT</span><br><span class="line">    from Logs, (select @prev := null, @count := null) as t</span><br><span class="line">)as temp</span><br><span class="line">where temp.CNT &gt;=3;</span><br></pre></td></tr></table></figure>

<h2 id="LeetCode181-超过经理收入的员工"><a href="#LeetCode181-超过经理收入的员工" class="headerlink" title="LeetCode181 - 超过经理收入的员工"></a>LeetCode181 - 超过经理收入的员工</h2><p><img src="https://pic.imgdb.cn/item/60a50f446ae4f77d35f0429a.png" alt="image-20210519211444600"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">	e1.Name as Employee </span><br><span class="line">from </span><br><span class="line">	Employee e1, Employee e2 </span><br><span class="line">where </span><br><span class="line">	e1.ManagerId = e2.Id </span><br><span class="line">and </span><br><span class="line">	e1.Salary &gt; e2.Salary;</span><br></pre></td></tr></table></figure>

<h2 id="LeetCode182-查找重复的电子邮箱"><a href="#LeetCode182-查找重复的电子邮箱" class="headerlink" title="LeetCode182 - 查找重复的电子邮箱"></a>LeetCode182 - 查找重复的电子邮箱</h2><p><img src="https://pic.imgdb.cn/item/60a50f9d6ae4f77d35f362b1.png" alt="image-20210519211613666"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">    distinct Email </span><br><span class="line">from </span><br><span class="line">    Person </span><br><span class="line">group by </span><br><span class="line">    Email </span><br><span class="line">having </span><br><span class="line">    count(*) &gt;1;</span><br></pre></td></tr></table></figure>

<h2 id="LeetCode183-从不订购的客户"><a href="#LeetCode183-从不订购的客户" class="headerlink" title="LeetCode183 - 从不订购的客户"></a>LeetCode183 - 从不订购的客户</h2><p><img src="https://pic.imgdb.cn/item/60a50fd56ae4f77d35f54ed3.png" alt="image-20210519211709452"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">    Name as Customers </span><br><span class="line">from </span><br><span class="line">    Customers left join Orders on Customers.Id=Orders.CustomerId </span><br><span class="line">where </span><br><span class="line">    Orders.Id is null;</span><br></pre></td></tr></table></figure>

<h2 id="LeetCode184-部门工资最高的员工"><a href="#LeetCode184-部门工资最高的员工" class="headerlink" title="LeetCode184 - 部门工资最高的员工"></a>LeetCode184 - 部门工资最高的员工</h2><p><img src="https://pic.imgdb.cn/item/60a510096ae4f77d35f72d02.png" alt="image-20210519211801362"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">select</span><br><span class="line">    d.Name as Department,</span><br><span class="line">    e.Name as Employee,</span><br><span class="line">    e.Salary</span><br><span class="line">from</span><br><span class="line">    Employee e,</span><br><span class="line">    Department d</span><br><span class="line">where</span><br><span class="line">    e.DepartmentId=d.Id</span><br><span class="line">    and</span><br><span class="line">    (e.Salary, e.DepartmentId) in (select max(Salary), DepartmentId from Employee group by DepartmentId);</span><br></pre></td></tr></table></figure>

<h2 id="LeetCode185-部门工资前3高的所有员工"><a href="#LeetCode185-部门工资前3高的所有员工" class="headerlink" title="LeetCode185 - 部门工资前3高的所有员工"></a>LeetCode185 - 部门工资前3高的所有员工</h2><p><img src="https://pic.imgdb.cn/item/60a510926ae4f77d35fbf9ad.png" alt="image-20210519212017738"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">select</span><br><span class="line">    d.Name as Department,</span><br><span class="line">    e2.Name as Employee,</span><br><span class="line">    e2.Salary</span><br><span class="line">from</span><br><span class="line">    Employee e1,</span><br><span class="line">    Employee e2,</span><br><span class="line">    Department d</span><br><span class="line">where</span><br><span class="line">    e1.DepartmentId=e2.DepartmentId</span><br><span class="line">and</span><br><span class="line">    e2.DepartmentId=d.Id</span><br><span class="line">and</span><br><span class="line">    e1.Salary &gt;= e2.Salary</span><br><span class="line">group by</span><br><span class="line">    e2.Salary,</span><br><span class="line">    e2.Name,</span><br><span class="line">    Department</span><br><span class="line">having</span><br><span class="line">    count(distinct e1.Salary) &lt;= 3</span><br><span class="line">order by</span><br><span class="line">    Department,</span><br><span class="line">    e2.Salary desc;</span><br></pre></td></tr></table></figure>

<h2 id="LeetCode196-删除重复的电子邮箱"><a href="#LeetCode196-删除重复的电子邮箱" class="headerlink" title="LeetCode196 - 删除重复的电子邮箱"></a>LeetCode196 - 删除重复的电子邮箱</h2><p><img src="https://pic.imgdb.cn/item/60a510756ae4f77d35faf54d.png" alt="image-20210519211949502"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">delete </span><br><span class="line">    p1 </span><br><span class="line">from </span><br><span class="line">    Person p1,</span><br><span class="line">    Person p2</span><br><span class="line">where </span><br><span class="line">    p1.Email=p2.Email </span><br><span class="line">and </span><br><span class="line">    p1.Id&gt;p2.Id;</span><br></pre></td></tr></table></figure>

<h2 id="LeetCode197-上升的温度"><a href="#LeetCode197-上升的温度" class="headerlink" title="LeetCode197 - 上升的温度"></a>LeetCode197 - 上升的温度</h2><p><img src="https://pic.imgdb.cn/item/60a510ac6ae4f77d35fcf536.png" alt="image-20210519212044479"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">select</span><br><span class="line">    a.Id</span><br><span class="line">from</span><br><span class="line">    Weather a </span><br><span class="line">join </span><br><span class="line">    Weather b</span><br><span class="line">on</span><br><span class="line">    a.Temperature &gt; b.Temperature</span><br><span class="line">and</span><br><span class="line">    dateDiff(a.recordDate, b.recordDate) = 1</span><br><span class="line">;</span><br></pre></td></tr></table></figure>

<h2 id="LeetCode262-行程和用户"><a href="#LeetCode262-行程和用户" class="headerlink" title="LeetCode262 - 行程和用户"></a>LeetCode262 - 行程和用户</h2><p><img src="https://pic.imgdb.cn/item/60a510f56ae4f77d35ff9da2.png" alt="image-20210519212156974"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">select</span><br><span class="line">    t.request_at Day,</span><br><span class="line">    (</span><br><span class="line">        round(count(if (t.status != &#x27;completed&#x27;, t.status, null)) / count(t.status), 2)</span><br><span class="line">    ) as &#x27;Cancellation Rate&#x27;</span><br><span class="line">from</span><br><span class="line">    Users u inner join Trips t on u.Users_id = t.Client_Id,</span><br><span class="line">    Users f inner join Trips n on f.Users_id = n.Driver_Id</span><br><span class="line">where</span><br><span class="line">    t.request_at</span><br><span class="line">between</span><br><span class="line">    &#x27;2013-10-01&#x27;</span><br><span class="line">and</span><br><span class="line">    &#x27;2013-10-03&#x27;</span><br><span class="line">and</span><br><span class="line">    u.banned != &#x27;Yes&#x27;</span><br><span class="line">and</span><br><span class="line">    f.banned != &#x27;Yes&#x27;</span><br><span class="line">and</span><br><span class="line">    t.Id = n.Id</span><br><span class="line">group by</span><br><span class="line">    t.request_at;</span><br></pre></td></tr></table></figure>

<h2 id="LeetCode595-大的国家"><a href="#LeetCode595-大的国家" class="headerlink" title="LeetCode595 - 大的国家"></a>LeetCode595 - 大的国家</h2><p><img src="https://pic.imgdb.cn/item/60a511296ae4f77d3501819d.png" alt="image-20210519212248764"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">    name, </span><br><span class="line">    population, </span><br><span class="line">    area</span><br><span class="line">from</span><br><span class="line">    World</span><br><span class="line">where</span><br><span class="line">    area &gt; 3000000</span><br><span class="line">or</span><br><span class="line">    population &gt; 25000000</span><br><span class="line">;</span><br></pre></td></tr></table></figure>

<h2 id="LeetCode596-超过5名学生的课"><a href="#LeetCode596-超过5名学生的课" class="headerlink" title="LeetCode596 - 超过5名学生的课"></a>LeetCode596 - 超过5名学生的课</h2><p><img src="https://pic.imgdb.cn/item/60a511596ae4f77d35033855.png" alt="image-20210519212337223"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">select</span><br><span class="line">    class</span><br><span class="line">from</span><br><span class="line">    (select</span><br><span class="line">        class,</span><br><span class="line">        count(*) as count_num</span><br><span class="line">    from </span><br><span class="line">        (</span><br><span class="line">            select</span><br><span class="line">                distinct student, class</span><br><span class="line">            from</span><br><span class="line">                courses</span><br><span class="line">        ) as c</span><br><span class="line">    group by</span><br><span class="line">        class</span><br><span class="line">    ) as num</span><br><span class="line">where</span><br><span class="line">    count_num &gt;= 5</span><br><span class="line">;</span><br></pre></td></tr></table></figure>

<h2 id="LeetCode601-体育馆的人流量"><a href="#LeetCode601-体育馆的人流量" class="headerlink" title="LeetCode601 - 体育馆的人流量"></a>LeetCode601 - 体育馆的人流量</h2><p><img src="https://pic.imgdb.cn/item/60a511926ae4f77d35052e73.png" alt="image-20210519212434296"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">select</span><br><span class="line">    distinct a.*</span><br><span class="line">from</span><br><span class="line">    stadium a,</span><br><span class="line">    stadium b,</span><br><span class="line">    stadium c</span><br><span class="line">where</span><br><span class="line">    (a.people&gt;=100 and b.people&gt;=100 and c.people&gt;=100)</span><br><span class="line">and(</span><br><span class="line">    (a.id = b.id-1 and b.id=c.id-1)</span><br><span class="line">    or</span><br><span class="line">    (a.id = b.id+1 and a.id=c.id-1)</span><br><span class="line">    or</span><br><span class="line">    (a.id = b.id+2 and a.id=c.id+1)</span><br><span class="line">)</span><br><span class="line">order by</span><br><span class="line">    a.visit_date</span><br><span class="line">;</span><br></pre></td></tr></table></figure>

<h2 id="LeetCode620-有趣的电影"><a href="#LeetCode620-有趣的电影" class="headerlink" title="LeetCode620 - 有趣的电影"></a>LeetCode620 - 有趣的电影</h2><p><img src="https://pic.imgdb.cn/item/60a511c56ae4f77d3506e869.png" alt="image-20210519212524778"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">select</span><br><span class="line">    *</span><br><span class="line">from</span><br><span class="line">    cinema</span><br><span class="line">where</span><br><span class="line">    description!=&#x27;boring&#x27;</span><br><span class="line">and</span><br><span class="line">    id%2=1</span><br><span class="line">order by</span><br><span class="line">    rating</span><br><span class="line">desc;</span><br></pre></td></tr></table></figure>

<h2 id="LeetCode626-换座位"><a href="#LeetCode626-换座位" class="headerlink" title="LeetCode626 - 换座位"></a>LeetCode626 - 换座位</h2><p><img src="https://pic.imgdb.cn/item/60a512066ae4f77d35090f69.png" alt="image-20210519212629828"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">select</span><br><span class="line">    (case</span><br><span class="line">        when mod(id,2)=1 and id=(select count(*) from seat) then id</span><br><span class="line">        when mod(id,2)=1 then id+1</span><br><span class="line">        else id-1</span><br><span class="line">    end) as id, student</span><br><span class="line">from</span><br><span class="line">    seat</span><br><span class="line">order by</span><br><span class="line">    id</span><br><span class="line">;</span><br></pre></td></tr></table></figure>

<h2 id="LeetCode627-变更性别"><a href="#LeetCode627-变更性别" class="headerlink" title="LeetCode627 - 变更性别"></a>LeetCode627 - 变更性别</h2><p><img src="https://pic.imgdb.cn/item/60a5122c6ae4f77d350a53fc.png" alt="image-20210519212707998"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">update </span><br><span class="line">    salary </span><br><span class="line">set </span><br><span class="line">    sex=(if(sex=&#x27;f&#x27;, &#x27;m&#x27;, &#x27;f&#x27;));</span><br></pre></td></tr></table></figure>

<h2 id="LeetCode1179-重新格式化部门表"><a href="#LeetCode1179-重新格式化部门表" class="headerlink" title="LeetCode1179 - 重新格式化部门表"></a>LeetCode1179 - 重新格式化部门表</h2><p><img src="https://pic.imgdb.cn/item/60a5125d6ae4f77d350c0426.png" alt="image-20210519212756930"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># 暴力</span><br><span class="line">select </span><br><span class="line">    distinct id</span><br><span class="line">    , sum(case `month` when &#x27;Jan&#x27; then revenue else null end) as Jan_Revenue</span><br><span class="line">    , sum(case `month` when &#x27;Feb&#x27; then revenue else null end) as Feb_Revenue</span><br><span class="line">    , sum(case `month` when &#x27;Mar&#x27; then revenue else null end) as Mar_Revenue</span><br><span class="line">    , sum(case `month` when &#x27;Apr&#x27; then revenue else null end) as Apr_Revenue</span><br><span class="line">    , sum(case `month` when &#x27;May&#x27; then revenue else null end) as May_Revenue</span><br><span class="line">    , sum(case `month` when &#x27;Jun&#x27; then revenue else null end) as Jun_Revenue</span><br><span class="line">    , sum(case `month` when &#x27;Jul&#x27; then revenue else null end) as Jul_Revenue</span><br><span class="line">    , sum(case `month` when &#x27;Aug&#x27; then revenue else null end) as Aug_Revenue</span><br><span class="line">    , sum(case `month` when &#x27;Sep&#x27; then revenue else null end) as Sep_Revenue</span><br><span class="line">    , sum(case `month` when &#x27;Oct&#x27; then revenue else null end) as Oct_Revenue</span><br><span class="line">    , sum(case `month` when &#x27;Nov&#x27; then revenue else null end) as Nov_Revenue</span><br><span class="line">    , sum(case `month` when &#x27;Dec&#x27; then revenue else null end) as Dec_Revenue</span><br><span class="line">from </span><br><span class="line">    Department </span><br><span class="line">group by </span><br><span class="line">    id;</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/MySQL/" rel="tag"># MySQL</a>
              <a href="/tags/LeetCode/" rel="tag"># LeetCode</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/05/18/%E4%B8%80%E5%A4%A9%E5%AD%A6%E5%AE%8CSQL%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/" rel="prev" title="一天学完SQL基本操作">
      <i class="fa fa-chevron-left"></i> 一天学完SQL基本操作
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#LeetCode175-%E7%BB%84%E5%90%88%E4%B8%A4%E4%B8%AA%E8%A1%A8"><span class="nav-number">1.</span> <span class="nav-text">LeetCode175 - 组合两个表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LeetCode176-%E7%AC%AC%E4%BA%8C%E9%AB%98%E7%9A%84%E8%96%AA%E6%B0%B4"><span class="nav-number">2.</span> <span class="nav-text">LeetCode176 - 第二高的薪水</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LeetCode177-%E7%AC%ACN%E9%AB%98%E7%9A%84%E8%96%AA%E6%B0%B4"><span class="nav-number">3.</span> <span class="nav-text">LeetCode177 - 第N高的薪水</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LeetCode178-%E5%88%86%E6%95%B0%E6%8E%92%E5%90%8D"><span class="nav-number">4.</span> <span class="nav-text">LeetCode178 - 分数排名</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LeetCode180-Z%E5%AD%97%E5%BD%A2%E5%8F%98%E6%8D%A2"><span class="nav-number">5.</span> <span class="nav-text">LeetCode180 - Z字形变换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LeetCode181-%E8%B6%85%E8%BF%87%E7%BB%8F%E7%90%86%E6%94%B6%E5%85%A5%E7%9A%84%E5%91%98%E5%B7%A5"><span class="nav-number">6.</span> <span class="nav-text">LeetCode181 - 超过经理收入的员工</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LeetCode182-%E6%9F%A5%E6%89%BE%E9%87%8D%E5%A4%8D%E7%9A%84%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1"><span class="nav-number">7.</span> <span class="nav-text">LeetCode182 - 查找重复的电子邮箱</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LeetCode183-%E4%BB%8E%E4%B8%8D%E8%AE%A2%E8%B4%AD%E7%9A%84%E5%AE%A2%E6%88%B7"><span class="nav-number">8.</span> <span class="nav-text">LeetCode183 - 从不订购的客户</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LeetCode184-%E9%83%A8%E9%97%A8%E5%B7%A5%E8%B5%84%E6%9C%80%E9%AB%98%E7%9A%84%E5%91%98%E5%B7%A5"><span class="nav-number">9.</span> <span class="nav-text">LeetCode184 - 部门工资最高的员工</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LeetCode185-%E9%83%A8%E9%97%A8%E5%B7%A5%E8%B5%84%E5%89%8D3%E9%AB%98%E7%9A%84%E6%89%80%E6%9C%89%E5%91%98%E5%B7%A5"><span class="nav-number">10.</span> <span class="nav-text">LeetCode185 - 部门工资前3高的所有员工</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LeetCode196-%E5%88%A0%E9%99%A4%E9%87%8D%E5%A4%8D%E7%9A%84%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1"><span class="nav-number">11.</span> <span class="nav-text">LeetCode196 - 删除重复的电子邮箱</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LeetCode197-%E4%B8%8A%E5%8D%87%E7%9A%84%E6%B8%A9%E5%BA%A6"><span class="nav-number">12.</span> <span class="nav-text">LeetCode197 - 上升的温度</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LeetCode262-%E8%A1%8C%E7%A8%8B%E5%92%8C%E7%94%A8%E6%88%B7"><span class="nav-number">13.</span> <span class="nav-text">LeetCode262 - 行程和用户</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LeetCode595-%E5%A4%A7%E7%9A%84%E5%9B%BD%E5%AE%B6"><span class="nav-number">14.</span> <span class="nav-text">LeetCode595 - 大的国家</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LeetCode596-%E8%B6%85%E8%BF%875%E5%90%8D%E5%AD%A6%E7%94%9F%E7%9A%84%E8%AF%BE"><span class="nav-number">15.</span> <span class="nav-text">LeetCode596 - 超过5名学生的课</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LeetCode601-%E4%BD%93%E8%82%B2%E9%A6%86%E7%9A%84%E4%BA%BA%E6%B5%81%E9%87%8F"><span class="nav-number">16.</span> <span class="nav-text">LeetCode601 - 体育馆的人流量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LeetCode620-%E6%9C%89%E8%B6%A3%E7%9A%84%E7%94%B5%E5%BD%B1"><span class="nav-number">17.</span> <span class="nav-text">LeetCode620 - 有趣的电影</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LeetCode626-%E6%8D%A2%E5%BA%A7%E4%BD%8D"><span class="nav-number">18.</span> <span class="nav-text">LeetCode626 - 换座位</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LeetCode627-%E5%8F%98%E6%9B%B4%E6%80%A7%E5%88%AB"><span class="nav-number">19.</span> <span class="nav-text">LeetCode627 - 变更性别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LeetCode1179-%E9%87%8D%E6%96%B0%E6%A0%BC%E5%BC%8F%E5%8C%96%E9%83%A8%E9%97%A8%E8%A1%A8"><span class="nav-number">20.</span> <span class="nav-text">LeetCode1179 - 重新格式化部门表</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Zek Shawn</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">8</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/ZekShawn" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ZekShawn" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ZekShawn</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
